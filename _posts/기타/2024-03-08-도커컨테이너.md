---
title: ë„ì»¤ ì»¨í…Œì´ë„ˆ
date: 2024-03-08 16:24:00 +09:00
categories: ["ê¸°íƒ€", "ë„ì»¤"]
tags: []
toc: true
toc_sticky: true
---

## âœ¨ë„ì»¤ ì»¨í…Œì´ë„ˆì— í™˜ê²½ë³€ìˆ˜ ì „ë‹¬ (2ê°€ì§€)

### í”„ë¡œì íŠ¸ ê¸°ë³¸ êµ¬ì„±

#### â— ì´ë¯¸ì§€ ì´ë¦„

hello:0.1

#### â— í´ë” êµ¬ì¡°

```
â”œâ”€â”€ Dockerfile
â””â”€â”€ hello.py
```

#### â— Dockerfile ë‚´ìš©

```
# ë² ì´ìŠ¤ ì´ë¯¸ì§€ ì„¤ì •
FROM ubuntu:22.04

# íŒ¨í‚¤ì§€ ì„¤ì¹˜
RUN apt-get update && apt-get install -y python3

# ì‘ìš© ìŠ¤í¬ë¦½íŠ¸ ë³µì‚¬
COPY hello.py .

# ì»¨í…Œì´ë„ˆ ì‹œì‘ ì‹œ ì‹¤í–‰í•  ëª…ë ¹ ì„¤ì •
CMD ["python3", "hello.py"]

```

#### â— hello.py íŒŒì¼ ë‚´ìš©

```py
print('Hello world from Python!')
```

## âœ¨ë„ì»¤ì—ì„œ í™˜ê²½ ë³€ìˆ˜ ì´ìš©í•´ë³´ê¸°

### 1. hello.py íŒŒì¼ ë‚´ìš© ë³€ê²½

```python
import os

print("Hello world from %s!" %os.environ["NAME"])
```

#### â— ë³€ê²½ëœ ë‚´ìš©ì„ ì°ì–´ë³´ê¸°

ğŸ’»ëª…ë ¹ì–´

```
cat hello.py
```

ğŸ’¡ê²°ê³¼

```
import os

print("Hello world from %s!" %os.environ["NAME"])
```

### 2. Dockerfile ë‚´ìš© ë³€ê²½

```
# ë² ì´ìŠ¤ ì´ë¯¸ì§€ ì„¤ì •
FROM ubuntu:22.04

ENV NAME Grepp

# íŒ¨í‚¤ì§€ ì„¤ì¹˜
RUN apt-get update && apt-get install -y python3

# ì‘ìš© ìŠ¤í¬ë¦½íŠ¸ ë³µì‚¬
COPY hello.py .

# ì»¨í…Œì´ë„ˆ ì‹œì‘ ì‹œ ì‹¤í–‰í•  ëª…ë ¹ ì„¤ì •
CMD ["python3", "hello.py"]
```

#### â— ë³€ê²½ëœ ë‚´ìš©ì„ ì°ì–´ë³´ê¸°

ğŸ’»ëª…ë ¹ì–´

```
cat Dockerfile
```

ğŸ’¡ê²°ê³¼

```
# ë² ì´ìŠ¤ ì´ë¯¸ì§€ ì„¤ì •
FROM ubuntu:22.04

ENV NAME Grepp

# íŒ¨í‚¤ì§€ ì„¤ì¹˜
RUN apt-get update && apt-get install -y python3

# ì‘ìš© ìŠ¤í¬ë¦½íŠ¸ ë³µì‚¬
COPY hello.py .

# ì»¨í…Œì´ë„ˆ ì‹œì‘ ì‹œ ì‹¤í–‰í•  ëª…ë ¹ ì„¤ì •
CMD ["python3", "hello.py"]
```

### 3. ë‹¤ì‹œ ìƒˆë¡œìš´ ì´ë¯¸ì§€ ë§Œë“¤ê¸°

ğŸ’»ëª…ë ¹ì–´

```
docker build -t hello:0.2 .
```

#### â— docker ì´ë¯¸ì§€ ëª©ë¡ì— ìˆëŠ”ì§€ í™•ì¸í•˜ê¸°

ğŸ’»ëª…ë ¹ì–´

```
docker images
```

ğŸ’¡ê²°ê³¼

```
REPOSITORY         TAG       IMAGE ID       CREATED          SIZE
hello              0.2       92be953756cb   29 seconds ago   157MB
```

#### â— docker ì‹¤í–‰í•˜ê¸°

ğŸ’»ëª…ë ¹ì–´

```
docker run hello:0.2
```

ğŸ’¡ê²°ê³¼

Greppì´ í™˜ê²½ ë³€ìˆ˜ë¡œ ì •í•´ì ¸ ìˆëŠ” ê²ƒ

```
Hello world from Grepp!
```

### 4. í™˜ê²½ë³€ìˆ˜ì˜ ê°’ ì„¤ì •í•˜ê¸°

íŒŒì¼ì— ìˆëŠ” í™˜ê²½ë³€ìˆ˜ NAMEì˜ ê°’ì„ ì§€ì •

ğŸ’»ëª…ë ¹ì–´

```
docker run -e NAME=Programmers hello:0.2
```

ğŸ’¡ê²°ê³¼

```
Hello world from Programmers!
```

#### `-e`ì˜µì…˜ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì‹¤í–‰ì„ ì‹œí‚¨ë‹¤ë©´ íŒŒì¼ì— ìˆëŠ” í™˜ê²½ë³€ìˆ˜ë¡œ ì‹¤í–‰ì´ ë¨

```
Hello world from Grepp!
```

### 5. ì‹¤í–‰ì´ ëë‚œ ì»¨í…Œì´ë„ˆ ìë™ ì‚­ì œí•˜ê¸°

`docker run` ëª…ë ¹ì— `--rm` ì˜µì…˜ì„ ë¶™ì´ë©´ ì‹¤í–‰ì´ ì™„ë£Œë˜ë©´ ì»¨í…Œì´ë„ˆê°€ ì‚­ì œë¨
ğŸ’»ëª…ë ¹ì–´

```
docker run --rm -e NAME=DOCKER-rm hello:0.2
```

ğŸ’¡ê²°ê³¼

```
Hello world from DOCKER-rm!
```

`docker ps -a`ë¡œ ëª©ë¡ í™•ì¸í•´ë³´ë©´ ì‹¤í–‰ì´ ì™„ë£Œëœ ì»¨í…Œì´ë„ˆê°€ ì‚­ì œë˜ì—ˆìŒì„ í™•ì¸í•  ìˆ˜ ìˆìŒ

## âœ¨docker ì»¨í…Œì´ë„ˆ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰í•˜ê¸°

### 1. `-d`ì˜µì…˜ ì‚¬ìš©í•´ì„œ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰í•˜ê¸°

ğŸ’»ëª…ë ¹ì–´

```
docker run -d --rm tomcat
```

ğŸ’¡ê²°ê³¼

```
Unable to find image 'tomcat:latest' locally
latest: Pulling from library/tomcat
23828d760c7b: Pull complete
e2670537dceb: Pull complete
c44aaba36909: Pull complete
c3b64924ef70: Pull complete
737fef02af8d: Pull complete
5d177a8f8e88: Pull complete
018443d5073c: Pull complete
3694d382f9eb: Pull complete
Digest: sha256:c83cd6449a4d34d6c5a9fe1193
Status: Downloaded newer image for tomcat:latest
35d315c695c7654415653062a110c8eecf341988641b8e3f6e
```

#### â–  ì»¨í…Œì´ë„ˆì˜ ë¡œê·¸ í™•ì¸í•˜ê¸°

ğŸ’»ëª…ë ¹ì–´

```
docker logs 35d315c695c7
```

ëª…ë ¹ì–´ ëœ¯ì–´ë³´ê¸°

- `logs`: docker ì»¨í…Œì´ë„ˆì˜ ë¡œê·¸ë¥¼ í™•ì¸í•˜ëŠ” ëª…ë ¹ì–´
  - `docker logs [ì»¨í…Œì´ë„ˆ ID | ì»¨í…Œì´ë„ˆ ì´ë¦„]`

#### â–  ìƒì„¸ë‚´ìš© í™•ì¸í•˜ê¸°\_IPì£¼ì†Œ í™•ì¸í•˜ê¸°

ğŸ’»ëª…ë ¹ì–´

```
docker inspect 35d315c695c7
```

ëª…ë ¹ì–´ ëœ¯ì–´ë³´ê¸°

- `inspect`: docker ì»¨í…Œì´ë„ˆì˜ ì„¸ë¶€ ì •ë³´ë¥¼ í™•ì¸í•˜ëŠ” ëª…ë ¹ì–´ (ì»¨í…Œì´ë„ˆ ì„¤ì •, ë„¤íŠ¸ì›Œí¬ ì„¤ì •, IP ì£¼ì†Œ ì •ë³´ë“¤ì´ í¬í•¨)
  - `docker inspect [ì»¨í…Œì´ë„ˆ ID | ì»¨í…Œì´ë„ˆ ì´ë¦„]`

ğŸ’¡ê²°ê³¼

```
...ìƒëµ
"Ports": {
    "8080/tcp": null
},
"IPAddress": "172.17.0.3",
```

## âœ¨ì™¸ë¶€ë¡œë¶€í„°ë„ ì ‘ì† ê°€ëŠ¥í•˜ê²Œ í•˜ê¸° (í˜¸ìŠ¤íŠ¸ì˜ í¬íŠ¸ì™€ ì»¨í…Œì´ë„ˆ í¬íŠ¸ë¥¼ ì—°ê²°)

í˜¸ìŠ¤íŠ¸ì˜ íŠ¹ì • í¬íŠ¸ë¥¼ íŠ¹ì • ì»¨í…Œì´ë„ˆì˜ íŠ¹ì • í¬íŠ¸ì™€ ì—°ê²°í•˜ëŠ” ë°©ë²•ì´ í•„ìš”

### 1. `p`ì˜µì…˜ì„ ì‚¬ìš©

`docker run -p [í˜¸ìŠ¤íŠ¸í¬íŠ¸ë²ˆí˜¸:ì»¨í…Œì´ë„ˆì˜ í¬íŠ¸] [ì´ë¯¸ì§€ì´ë¦„]`

ğŸ’»ëª…ë ¹ì–´

```
docker run -d --rm -p 8888:8080 tomcat
```

ğŸ’¡ê²°ê³¼

dockerì˜ ì‹¤í–‰ ëª©ë¡ì„ í™•ì¸í•´ë³´ë©´ `localhost:8888`, `localhost:8080` ëª¨ë‘ ê°™ì€ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆìŒ

```
CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS         PORTS
   NAMES
4840e22f1af8   tomcat    "catalina.sh run"        11 seconds ago   Up 5 seconds   0.0.0.0:8888->8080/tcp   intelligent_jenning
```
