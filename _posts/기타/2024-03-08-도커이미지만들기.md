---
title: ë„ì»¤ ì´ë¯¸ì§€ ë§Œë“¤ê¸°
date: 2024-03-08 16:24:00 +09:00
categories: ["ê¸°íƒ€", "ë„ì»¤"]
tags: []
toc: true
toc_sticky: true
---

## ë„ì»¤ ì´ë¯¸ì§€ ë§Œë“¤ê¸°

### 1. dockerë¥¼ ì‚¬ìš©í•´ì„œ httpd ì´ë¯¸ì§€ì—ì„œ ì‰˜ì„ ì‹¤í–‰í•˜ê¸°

```
$ docker run -it httpd /bin/bash
```

ëª…ë ¹ì–´ ëœ¯ì–´ë³´ê¸°

- `docker run`: docker ì»¨í…Œì´ë„ˆ ì‹¤í–‰
- `-it`: ì»¨í…Œì´ë„ˆì™€ ìƒí˜¸ì‘ìš©í•˜ê¸° ìœ„í•œ ì˜µì…˜
  - `i`: interactive(ëŒ€í™”í˜•)ë¥¼ ì˜ë¯¸, í‘œì¤€ ì…ë ¥ì„ ìœ ì§€í•˜ê³  ì»¨í…Œì´ë„ˆë¥¼ ìœ ì§€ì‹œí‚¤ëŠ” ì—­í• 
  - `t`: ttyë¥¼ ì˜ë¯¸, ê°€ìƒ í„°ë¯¸ë„ ì¥ì¹˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆì™€ ìƒí˜¸ì‘ìš©í•  ìˆ˜ ìˆê²Œ í•´ì¤Œ
- `httpd`: ì‹¤í–‰í•  docker ì´ë¯¸ì§€ ì´ë¦„
- `/bin/bash`: ì‰˜ì„ ì‹¤í–‰í•˜ëŠ” ëª…ë ¹ì–´(ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ ì‹¤í–‰í•  ëª…ë ¹ì–´)

### 2. ê¸°ë³¸ ë””ë ‰í† ë¦¬ ì§€ì •í•˜ê¸°

```
/usr/local/apache2# grep DocumentRoot /usr/local/apache2/conf/httpd.conf
```

ëª…ë ¹ì–´ ëœ¯ì–´ë³´ê¸°

- `grep`: ì£¼ì–´ì§„ íŒŒì¼ì—ì„œ ì§€ì •ëœ íŒ¨í„´ì„ ê²€ìƒ‰í•˜ëŠ” ëª…ë ¹ì–´
- `DocumentRoot`: Apache ì„¤ì •íŒŒì¼ì—ì„œ ì›¹ì„œë²„ê°€ ë¬¸ì„œë¥¼ ì œê³µí•˜ëŠ” ê¸°ë³¸ ë””ë ‰í† ë¦¬ë¥¼ ì§€ì •í•˜ëŠ” ì§€ì‹œë¬¸
- `httpd.conf`: ì›¹ ì„œë²„ì˜ ì£¼ìš” ì„¤ì • íŒŒì¼

### 3. í˜„ì¬ ì‘ì—… ë””ë ‰í† ë¦¬ í™•ì¸í•˜ê¸°

```
/usr/local/apache2# pwd
```

### 4. í˜„ì¬ ë””ë ‰í† ë¦¬ì— ìˆëŠ” íŒŒì¼ê³¼ ëª©ë¡ í™•ì¸í•˜ê¸°

```
/usr/local/apache2# ls -l
```

ğŸ’¡ê²°ê³¼

```
total 40
drwxr-xr-x 2 root root 4096 Feb 13 01:55 bin
drwxr-xr-x 2 root root 4096 Feb 13 01:55 build
drwxr-xr-x 2 root root 4096 Feb 13 01:55 cgi-bin
drwxr-xr-x 4 root root 4096 Feb 13 01:55 conf
drwxr-xr-x 3 root root 4096 Feb 13 01:55 error
drwxr-xr-x 2 root root 4096 Feb 13 01:55 htdocs
drwxr-xr-x 3 root root 4096 Feb 13 01:55 icons
drwxr-xr-x 2 root root 4096 Feb 13 01:55 include
drwxr-xr-x 2 root root 4096 Feb 13 01:55 logs
drwxr-xr-x 2 root root 4096 Feb 13 01:55 modules
```

### 5. htdocsí´ë”ë¡œ ì´ë™

```
/usr/local/apache2# cd htdocs
```

ëª…ë ¹ì–´ ëœ¯ì–´ë³´ê¸°

- cd: í´ë”ë¥¼ ì´ë™í•˜ëŠ” ëª…ë ¹ì–´

### 6. hotdocsì— ìˆëŠ” íŒŒì¼ ëª©ë¡ í™•ì¸í•˜ê¸°

```
/usr/local/apache2/htdocs# ls -l
```

ğŸ’¡ê²°ê³¼

```
total 4
-rw-r--r-- 1 504 staff 45 Jun 11  2007 index.html
```

### 7. index.html ë‚´ìš© í™•ì¸í•˜ê¸°

```
/usr/local/apache2/htdocs# cat index.html
```

ëª…ë ¹ì–´ ëœ¯ì–´ë³´ê¸°

- `cat` íŒŒì¼ì˜ ë‚´ìš©ì„ í™”ë©´ì— ì¶œë ¥í•˜ëŠ” ëª…ë ¹ì–´
  - `cat [ì˜µì…˜] [íŒŒì¼ëª…]`í˜•ì‹ìœ¼ë¡œ ì‚¬ìš©

ğŸ’¡ê²°ê³¼

```
<html><body><h1>It works!</h1></body></html>
```

### 8. index.html íŒŒì¼ ë‚´ìš© ë³€ê²½í•˜ê¸°

```
/usr/local/apache2/htdocs# cat > index.html
<html><body><h1>New Page!</h1></body></html>
```

ìœ„ì˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ê³  ë³€ê²½í•  ë‚´ìš©ì„ ëª¨ë‘ ì‘ì„±í–ˆë‹¤ë©´, `ctrl + d`ë¥¼ ëˆŒëŸ¬ì„œ ì…ë ¥ ì¢…ë£Œí•˜ê¸°

ëª…ë ¹ì–´ ëœ¯ì–´ë³´ê¸°

- `cat`: íŒŒì¼ì˜ ë‚´ìš©ì„ í™”ë©´ì— ì¶œë ¥í•˜ëŠ” ëª…ë ¹ì–´
- `>`: ë¦¬ë‹¤ì´ë ‰íŠ¸(ì—°ê²°)
- `<html><body><h1>New Page!</h1></body></html>`: ë³€ê²½í•  ë‚´ìš©

### 9. ë³€ê²½ëœ ë‚´ìš© í™•ì¸í•˜ê¸°

```
/usr/local/apache2/htdocs# httpd-foreground
```

ëª…ë ¹ì–´ ëœ¯ì–´ë³´ê¸°

- `httpd-foreground`: ì›¹ ì„œë²„ë¥¼ ì‹¤í–‰í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ëª…ë ¹ì–´

#### 9-1. ë˜ëŠ” ì»¤ë©˜ë“œ ë¼ì¸ì—ì„œ í™•ì¸í•˜ê¸°

```
/usr/local/apache2/htdocs# cat index.html
```

ğŸ’¡ê²°ê³¼

```
<html><body><h1>New Page!</h1></body></html>
```

### 10. ì‰˜ ì‹¤í–‰ ì¢…ë£Œí•˜ê¸°

```
:/usr/local/apache2/htdocs# exit
```

### 11. docker ì»¨í…Œì´ë„ˆ ëª©ë¡ í™•ì¸í•˜ê¸°

```
docker ps -a
```

ğŸ’¡ê²°ê³¼

```
CONTAINER ID   IMAGE     COMMAND                  CREATED             STATUS                            PORTS                    NAMES
a1b5e38aee50   httpd     "/bin/bash"              About an hour ago   Exited (127) About a minute ago                            optimistic_khayyam
```

### 12. ì¤‘ë‹¨ëœ ì»¨í…Œì´ë„ˆì— ë‹¤ì‹œ ì‰˜ì„ ë¶™ì´ê¸°

```
docker start a1b5e38aee50
```

ëª…ë ¹ì–´ ëœ¯ì–´ë³´ê¸°

- `start`: ì •ì§€ëœ ì»¨í…Œì´ë„ˆë¥¼ ë‹¤ì‹œ ì‹œì‘í•˜ëŠ”ë° ì‚¬ìš©í•˜ëŠ” ëª…ë ¹ì–´
  - `docker start [ì»¨í…Œì´ë„ˆ ID | ì»¨í…Œì´ë„ˆ ì´ë¦„]

#### ì—°ê²°ë˜ì—ˆëŠ”ì§€ í™•ì¸

```
docker ps
```

í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ docker ì»¨í…Œì´ë„ˆì˜ ëª©ë¡ì„ í™•ì¸í•˜ëŠ” ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì—¬ ì˜ ì‹¤í–‰ë˜ê³  ìˆëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŒ

ğŸ’¡ê²°ê³¼

```
CONTAINER ID   IMAGE     COMMAND                  CREATED             STATUS             PORTS                    NAMES
a1b5e38aee50   httpd     "/bin/bash"              About an hour ago   Up 40 seconds      80/tcp                   optimistic_khayyam
```

### 13. ì‹¤í–‰í•˜ê³  ìˆëŠ” ì»¨í…Œì´ë„ˆì— ìƒˆë¡œìš´ í„°ë¯¸ë„ì„ ë¶™ì—¬ì„œ bash shell ì–»ê¸°

```
docker exec -it a1b5e38aee50 /bin/bash
```

ğŸ’¡ê²°ê³¼

```
/usr/local/apache2#
```

### 14. ë³€ê²½í–ˆë˜ index.html ë‚´ìš© ë‹¤ì‹œ í™•ì¸í•˜ê¸°

```
/usr/local/apache2# cat ./htdocs/index.html
```

htdocs í´ë”ì— ìˆëŠ” index.htmlì˜ ë‚´ìš©ì„ í™•ì¸í•˜ê¸° ìœ„í•´ cat ëª…ë ¹ì–´ì™€ íŒŒì¼ì˜ ê²½ë¡œë¥¼ ì‘ì„±

ğŸ’¡ê²°ê³¼

```
<html><body><h1>New Page!</h1></body></html>
```

### 15. docker ì»¨í…Œì´ë„ˆì˜ ìƒíƒœë¥¼ ì´ë¯¸ì§€ë¡œ ì €ì¥í•˜ê¸°

```
docker commit a1b5e38aee50 my_httpd:0.1
```

ëª…ë ¹ì–´ ëœ¯ì–´ë³´ê¸°

- `commit`: docker ì»¨í…Œì´ë„ˆì˜ ìƒíƒœë¥¼ ì´ë¯¸ì§€ë¡œ ì €ì¥í•˜ëŠ” ëª…ë ¹ì–´
  - `commit [ì»¨í…Œì´ë„ˆ ID] [ì´ë¯¸ì§€ ì´ë¦„:íƒœê·¸]`
- `a1b5e38aee50`: ì»¤ë°‹í•˜ë ¤ëŠ” ì»¨í…Œì´ë„ˆ ì•„ì´ë””
- `my_httpd:0.1`: ìƒˆ ì´ë¯¸ì§€ì˜ ì´ë¦„ê³¼ íƒœê·¸

#### ì œëŒ€ë¡œ ì´ë¯¸ì§€ê°€ ì €ì¥ë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ë³´ê¸°

```
docker images
```

ğŸ’¡ê²°ê³¼

```
REPOSITORY   TAG       IMAGE ID       CREATED          SIZE
my_httpd     0.1       d42c557b5e46   19 seconds ago   167MB
```

### 16. ìƒˆë¡­ê²Œ ë§Œë“  ì´ë¯¸ì§€ ì‹¤í–‰í•˜ê¸°

```
docker run my_httpd:0.1 httpd-foreground
```

ğŸ’¡ê²°ê³¼

```
AH00558: httpd: Could not reliably determine the server's fully qualified domain name, using 172.17.0.4. Set the 'ServerName' directive globally to suppress this message
AH00558: httpd: Could not reliably determine the server's fully qualified domain name, using 172.17.0.4. Set the 'ServerName' directive globally to suppress this message
[Mon Mar 11 08:30:42.093345 2024] [mpm_event:notice] [pid 1:tid 139715227473792] AH00489: Apache/2.4.58 (Unix) configured -- resuming normal operations
[Mon Mar 11 08:30:42.093818 2024] [core:notice] [pid 1:tid 139715227473792] AH00094: Command line: 'httpd -D FOREGROUND'
```

## ì´ë¯¸ì§€ ìƒì„± ìë™í™”í•˜ê¸°

### ê°œë…

#### Dockerfile

- ê³„ì¸µ êµ¬ì¡°ë¥¼ ì´ìš©í•˜ì—¬ ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ë§Œë“œëŠ” ì ˆì°¨ë¥¼ ì‘ì„±í•˜ëŠ” íŒŒì¼
- `FROM [--platform=<platform>] <image> [AS <name>]`
- `RUN <command>`
- `ENTRYPOINT ["executable","param1","param2"]`

#### ì´ë¯¸ì§€ ë¹Œë“œ ëª…ë ¹ì–´

- `docker build [ì˜µì…˜] PATH | URL`

## ì´ë¯¸ì§€ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ì˜¬ë¦¬ê¸°

### 1. ë„ì»¤ í—ˆë¸Œì— ë¡œê·¸ì¸

```
docker login
```

ìœ„ì˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ê³ , ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ë©´ ë¡œê·¸ì¸ì´ ë¨

```
Login with your Docker ID to push and pull images from Docker Hub. If you don't have a Docker ID, head over to https://hub.docker.com to create one.
Username: [ì´ë©”ì¼ ì£¼ì†Œ]
Password:
WARNING! Your password will be stored unencrypted in /home/hm/snap/docker/2915/.docker/config.json.
Configure a credential helper to remove this warning. See
https://docs.docker.com/engine/reference/commandline/login/#credentials-store

Login Succeeded
```

### 2. ë§Œë“  ì´ë¯¸ì§€ì— íƒœê·¸ë¥¼ ë¶™ì´ê¸°

```
docker tag my_httpd:0.1 hyeem66/my_httpd:0.1
```

ëª…ë ¹ì–´ ëœ¯ì–´ë³´ê¸°

- `push`:
  - `push [ì»¨í…Œì´ë„ˆì´ë¦„:íƒœê·¸] [docker_hub_id/image name]`
- `my_httpd:0.1`: ì˜¬ë¦¬ë ¤ê³  í•˜ëŠ” ì»¨í…Œì´ë„ˆ ì´ë¦„:íƒœê·¸
- `hyeem66/my_httpd:0.1`: ë„ì»¤ í—ˆë¸Œ ì‚¬ìš©ì ì´ë¦„ì™€ ì´ë¯¸ì§€ ì´ë¦„:íƒœê·¸

#### ì œëŒ€ë¡œ íƒœê·¸ê°€ ë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ë³´ê¸°

```
docker images
```

ğŸ’¡ê²°ê³¼

```
REPOSITORY        TAG       IMAGE ID       CREATED          SIZE
my_httpd          0.1       d42c557b5e46   20 minutes ago   167MB
hyeem66/my_httpd   0.1       d42c557b5e46   20 minutes ago   167MB
```

### 3. ë¹Œë“œí•˜ê³ , ë„ì»¤ í—ˆë¸Œì— ì—…ë¡œë“œí•˜ê¸°

```
docker push hyeem66/my_httpd:0.1
```

ëª…ë ¹ì–´ ëœ¯ì–´ë³´ê¸°

- `push`: ì´ë¯¸ì§€ë¥¼ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ì—…ë¡œë“œí•˜ëŠ” ëª…ë ¹ì–´
- `hyeem66/my_httpd:0.1`: ì—…ë¡œë“œí•  docker ì´ë¯¸ì§€ì˜ ì´ë¦„ê³¼ íƒœê·¸
  - `hyem66`: docker hub ì‚¬ìš©ì ì´ë¦„
  - `my_httpd:0.1`: ì´ë¯¸ì§€ì´ë¦„:íƒœê·¸

ğŸ’¡ê²°ê³¼

```
The push refers to repository [docker.io/hyeem66/my_httpd]
4509f1dadbc3: Pushed
83e84e8d7bd1: Pushed
ee9a39d3b67e: Pushed
70d67450158d: Pushed
5f70bf18a086: Pushed
8f562cbc866f: Pushed
ceb365432eec: Pushed
0.1: digest: sha256:ec09f8... size: 1779
```

## ì´ë¯¸ì§€ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì—ì„œ ë‹¤ìš´ ë°›ì•„ì„œ ì‚¬ìš©í•˜ê¸°

```
docker run hyeem66/my_httpd:0.1
```

ğŸ’¡ê²°ê³¼  
localì— ì´ë¯¸ì§€ê°€ ì—†ìœ¼ë©´ í—ˆë¸Œì—ì„œ pull ë°›ì•„ì„œ ì‚¬ìš©

```
Unable to find image 'hyeem66/my_httpd:0.1' locally
0.1: Pulling from hyeem66/my_httpd
e1caac4eb9d2: Already exists
87b0fe460fd9: Already exists
4f4fb700ef54: Already exists
9cebd3e3b523: Already exists
e9304da947c5: Already exists
b60d4b66b268: Already exists
be2abe826808: Pull complete
...
```
